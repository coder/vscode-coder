{
	"root": true,
	"parser": "@typescript-eslint/parser",
	"parserOptions": {
		"ecmaVersion": 6,
		"sourceType": "module",
		"project": true
	},
	"plugins": ["@typescript-eslint", "prettier", "import"],
	"extends": [
		"eslint:recommended",
		"plugin:@typescript-eslint/recommended",
		"plugin:import/recommended",
		"plugin:import/typescript",
		"plugin:md/prettier",
		"prettier"
	],
	"ignorePatterns": ["out", "dist", "**/*.d.ts"],
	"settings": {
		"import/resolver": {
			"typescript": { "project": "./tsconfig.json" }
		},
		"import/internal-regex": "^@/"
	},
	"overrides": [
		{
			"files": ["*.ts"],
			"rules": {
				"require-await": "off",
				"@typescript-eslint/require-await": "error",
				"@typescript-eslint/consistent-type-imports": [
					"error",
					{
						"disallowTypeAnnotations": false, // Used in tests
						"prefer": "type-imports",
						"fixStyle": "inline-type-imports"
					}
				],
				"@typescript-eslint/switch-exhaustiveness-check": [
					"error",
					{ "considerDefaultExhaustiveForUnions": true }
				]
			}
		},
		{
			"files": ["test/**/*.{ts,tsx}", "**/*.{test,spec}.ts?(x)"],
			"settings": {
				"import/resolver": {
					"typescript": {
						// In tests, resolve using the test tsconfig
						"project": "test/tsconfig.json"
					}
				}
			}
		},
		{
			"files": ["src/core/contextManager.ts"],
			"rules": {
				"no-restricted-syntax": "off"
			}
		},
		{
			"extends": ["plugin:package-json/legacy-recommended"],
			"files": ["*.json"],
			"parser": "jsonc-eslint-parser"
		},
		{
			"files": ["*.md"],
			"parser": "markdown-eslint-parser"
		}
	],
	"rules": {
		"curly": "error",
		"eqeqeq": "error",
		"no-throw-literal": "error",
		"no-console": "error",
		"prettier/prettier": "error",
		"import/order": [
			"error",
			{
				"groups": [
					["builtin", "external"],
					"internal",
					"parent",
					["sibling", "index"],
					"type"
				],
				"pathGroups": [
					{ "pattern": "@/**", "group": "internal", "position": "before" }
				],
				"pathGroupsExcludedImportTypes": ["builtin", "external"],
				"newlines-between": "always",
				"alphabetize": { "order": "asc", "caseInsensitive": true },
				"sortTypesGroup": true
			}
		],
		// Prevent duplicates and prefer merging into a single import
		"no-duplicate-imports": "off",
		"import/no-duplicates": ["error", { "prefer-inline": true }],
		"import/no-unresolved": [
			"error",
			{
				"ignore": ["vscode"]
			}
		],
		"@typescript-eslint/no-unused-vars": [
			"error",
			{
				"varsIgnorePattern": "^_"
			}
		],
		"md/remark": [
			"error",
			{
				"no-duplicate-headings": {
					"sublings_only": true
				}
			}
		],
		"no-restricted-syntax": [
			"error",
			{
				"selector": "CallExpression[callee.property.name='executeCommand'][arguments.0.value='setContext'][arguments.length>=3]",
				"message": "Do not use executeCommand('setContext', ...) directly. Use the ContextManager class instead."
			}
		]
	}
}
